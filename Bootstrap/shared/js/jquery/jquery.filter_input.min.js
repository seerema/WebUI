!function(e){e.fn.extend({filter_input:function(t){t=e.extend({regex:".",live:!1,events:"keypress paste"},t);var n=e.isFunction(t.onChange),o=e.isFunction(t.onText),i=e.isFunction(t.onEmpty),r=e.isFunction(t.onEscape),a=e.isFunction(t.onEnter);function s(e){var t=!1;return"number"==typeof e.selectionStart&&(t=0==e.selectionStart&&e.selectionEnd==e.value.length),t}function f(e){var t=!1;return"number"==typeof e.selectionStart&&(t=e.selectionStart!=e.selectionEnd),t}function u(o){var a=o.input?o.input:this,u=a.value;if("keydown"==o.type){var c=o.charCode?o.charCode:o.keyCode?o.keyCode:0;if(8==c||46==c){if(i){if(s(a))return void t.onEmpty(e(a));if(1==u.length&&"number"==typeof a.selectionStart&&(8==c&&1==a.selectionStart||46==c&&0==a.selectionStart))return void t.onEmpty(e(a))}n&&(f(a)?t.onChange(e(a)):u.length>0&&"number"==typeof a.selectionStart&&(8==c&&a.selectionStart>0||46==c&&a.selectionEnd<a.value.length)&&t.onChange(e(a)))}else if(27==c)return void(r&&t.onEscape())}else if("cut"==o.type){if(i&&s(a))return void t.onEmpty(e(a));f(a)&&n&&t.onChange(e(a))}}function c(o){var i=o.input?o.input:e(this);if(!o.ctrlKey&&!o.altKey){if("keypress"==o.type){var r=o.charCode?o.charCode:o.keyCode?o.keyCode:0;if(13==r)return a&&t.onEnter(),!1;var s=String.fromCharCode(r),f=(i.val(),new RegExp(t.regex))}else{if("paste"==o.type)return i.data("value_before_paste",o.target.value),setTimeout(function(){c({type:"after_paste",input:i})},1),!0;if("after_paste"!=o.type)return!1;s=i.val(),i.val(),f=new RegExp("^("+t.regex+")+$")}return f.test(s)?(n&&t.onChange(i),!0):("function"==typeof t.feedback&&t.feedback.call(this,s),"after_paste"==o.type&&i.val(i.data("value_before_paste")),!1)}}var l=e.fn.jquery.split(".");if(!t.live)return this.each(function(){var r=e(this);if(i||n||o){var a="cut keydown";r.off(a).on(a,u)}if(o){a="keyup";r.off(a).on(a,function(e){16!=e.keyCode&&17!=e.keyCode&&18!=e.keyCode&&27!=e.keyCode&&t.onText(r.val())})}r.off(t.events).on(t.events,c)});parseInt(l[0])>=1&&parseInt(l[1])>=7?e(this).on(t.events,c):e(this).live(t.events,c)}})}(jQuery);